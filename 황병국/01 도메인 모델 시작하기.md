# 📘 도메인 주도 개발 (DDD) - 챕터 1 

## 도메인과 하위 도메인

- **도메인**: 우리가 해결하려는 문제 영역
- **하위 도메인(Subdomain)**: 하나의 도메인을 논리적으로 나눈 작은 영역들

> 예) 온라인 서점 도메인 →  
> 회원, 혜택, 주문, 카탈로그, 리뷰, 정산, 배송, 결제 등 하위 도메인으로 나눌 수 있음

- **하위 도메인은 서로 협력**하여 전체 기능을 완성  
  예: 고객이 구매할 때 → 주문 + 결제 + 배송 + 혜택 도메인 협력 필요

---

## 도메인 지식과 소통의 중요성

- **요구사항을 정확히 이해**해야 유용한 시스템을 만들 수 있음
- **개발자와 도메인 전문가가 직접 대화**해야 이해도가 올라감
- **개발자도 도메인 지식을 갖춰야** 제품 품질이 높아짐

> 이해관계자 + 개발자 + 도메인 전문가 = **같은 언어, 같은 지식**

---

## 용어 충돌 (Ubiquitous Language)

- 같은 단어도 **하위 도메인마다 의미가 다를 수 있음**
  
> 예: "상품"  
> - 카탈로그 도메인: 상품 설명 및 정보  
> - 배송 도메인: 실물 물품

- 따라서 각 도메인마다 **자체 모델을 따로 설계**해야 함

---

## 도메인 모델

- 핵심 규칙은 도메인 모델에만 위치시켜야 한다
- 이렇게 하면 규칙이 바뀌거나 확장되더라도 다른 코드에 영향이 적음
- 도메인 이해가 깊어지면 **메서드명 등도 자연스럽게 수정됨**

---

## 도메인 분석과 모델링

- 요구사항 → 점진적으로 도메인 모델로 발전시켜야 함

---

# 엔티티(Entity) vs 밸류(Value Object)

| 항목 | 엔티티 | 밸류 오브젝트 |
|------|--------|----------------|
| 특징 | 식별자 있음 | 식별자 없음 |
| 예시 | 주문(Order), 회원(Member) | 돈(Money), 주소(Address), 주문 라인(OrderLine) |

---

## 불변 밸류 타입

- 의미를 명확하게 표현 가능
- 상태 불완전 문제 방지

```java
public class Money {
    private final int value;

    public Money(int value) { this.value = value; }

    public Money add(Money m) { return new Money(this.value + m.value); }

    public Money multiply(int times) { return new Money(this.value * times); }
}
```

---

## setter를 통한 위험한 객체 생성 예

```java
Order order = new Order();
order.setOrderLine(lines);
order.setShippingInfo(shippingInfo);
// 누락된 주문자 정보!
order.setState(OrderState.PREPARING);
```

> ❌ 이 코드는 `Orderer`가 null인 상태에서 상태 변경됨 → 불안정한 상태

---

## 생성자를 통한 안전한 객체 생성

```java
Order order = new Order(orderer, lines, shippingInfo, OrderState.PREPARING);
```

> 생성자에서 **필수 데이터를 모두 전달**받아야 객체가 완전한 상태로 생성됨.
