<!-- TOC -->
* [2.1 네 개의 영역](#21-네-개의-영역)
* [2.2 계층 구조 아키텍처](#22-계층-구조-아키텍처)
* [2.3 DIP](#23-dip)
  * [2.3.1 DIP 주의 사항](#231-dip-주의-사항)
  * [2.3.2 DIP와 아키텍처](#232-dip와-아키텍처)
* [2.4 도메인 영역의 주요 구성 요소](#24-도메인-영역의-주요-구성-요소)
* [2.5 요청 처리 흐름](#25-요청-처리-흐름)
* [2.6 인프라스트럭처 개요](#26-인프라스트럭처-개요)
* [2.7 모듈 구성](#27-모듈-구성)
<!-- TOC -->

# 2.1 네 개의 영역

| 계층      | 역할                                                                                                    |
|---------|-------------------------------------------------------------------------------------------------------|
| 표현      | 사용자 요청을 받아 응용 영역에 전달. <br> 응용 영역 처리결과를 사용자에게 보여줌.                                                     |
| 응용      | 로직을 직접 수행하기 보다는 도메인 모델에 로직 수행을 위임                                                                     |
| 도메인     | 도메인 모델을 구현. <br> 핵심 로직 '배송지 변경', '결제 완료' 등 핵심 로직을 도메인 모델에서 구현 <br> Order, OrderLine, ShippingInfo ... |
| 인프라스트럭처 | 구현 기술에 대한 것을 다룬다                                                                                      |


- 도메인 영역, 응용 영역, 표현 영역은 구현 기술을 사용한 코드를 직접 만들지 않는다.
  - 대신 인프라 영역에서 제공하는 기능을 사용해서 필요한 기능을 개발

# 2.2 계층 구조 아키텍처

- 표현 -> 응용 -> 도메인 -> 인프라스트럭처
- 상위에서 하위 계층으로의 의존만 존재
  - 하위 계층에서 상위 계층으로 의존하지 않음
- 응용 계층은 도메인 계층에 의존하지만, 외부 시스템 연동을 위해 더 아래 계층인 이프라 계층에 의존하기도 함.
- 인프라 계층에 직접 의존하는 것의 단점
  - 다른 구현 기술 사용 시 많은 코드를 고쳐야한다.
  - 즉, 인프라에 의존하면 테스트 어려움과 기능 확장의 어려움이 존재.
   - 테스트 어려움, 기능 확장의 어려움을 해결하기 위해 인프라 계층에 의존하지 않도록 DIP를 적용한다.

# 2.3 DIP

- 인터페이스 이용해 DIP를 이용하면 저수준 모듈이 고수준 모듈에 의존
 - 원래는 고수준이 저수준에 의존했으므로, 이 과정에서 의존성 역전이 됨. 의존성 역전 원칙  

## 2.3.1 DIP 주의 사항

- 저수준 모듈에서 인터페이스를 추출하는 경우 존재. 이는 잘못된 구조.


## 2.3.2 DIP와 아키텍처

- DIP 적용 시 인프라 영역이 응용, 도메인 영역에 의존
- DIP를 항상 적용할 필요는 없음. 
 - 구현 기술을 의존할 때가 나을 때가 있다.
 - DIP의 이점을 얻는 수준에서의 적용 범위를 검토하자.

# 2.4 도메인 영역의 주요 구성 요소

| 요소      | 설명                                                                                                                                     |
|---------|----------------------------------------------------------------------------------------------------------------------------------------|
| 엔티티     | 고유 식별자를 갖고, 자신의 라이프 사이클 가짐. <br> 도메인 모델의 데이터를 포함하고 해당 데이터와 관련된 기능 제공.                                                                  |
| 밸류      | 고유 식별자 갖지 않고 개념적으로 하나의 값만 표현                                                                                                           |
| 애그리거트   | 연관된 엔티티와 밸류 객체를 개념적으로 하나로 묶은 것 <br> 예: Order 엔티티, OrderLine 밸류, Orderer 밸류 객체를 주문 애그리거트로 묶는다                                           |
| 리포지터리   | 도메인 모델 영속성 처리.                                                                                                                         |
| 도메인 서비스 | 특정 엔티티에 속하지 않은 도메인 로직 제공. <br> '할인 금액 계산': 상품, 쿠폰, 회원 등급, 구매 금액 등 다양한 조건을 이용하여 구현하게됨. <br> 도메인 로직이 여러 엔티티와 밸류를 필요하게 되면 도메인 서비스에서 로직 구현 |


# 2.5 요청 처리 흐름

# 2.6 인프라스트럭처 개요

# 2.7 모듈 구성

- 애그리거트, 모델, 리포지터리는 같은 패키지에 위치
 - Order, OrderLine, Orderer, OrderRepository는 com.myshop.order.domain 패키지에 위치
- 도메인 복잡할 경우 도멩니 모델과 도메인 서비스를 별도 패키지에 위치 가능
  - com.myshop.order.domain.order: 애그리거트 
  - com.myshop.order.domain.service: 도메인 서비스
- 응용 서비스도 도메인 별로 패키지 구분 가능
  - com.myshop.order.application.product
  - com.myshop.order.application.category